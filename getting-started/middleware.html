<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Middleware | Apiation Help Center</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#e5bce6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.4dc2ae66.css" as="style"><link rel="preload" href="/assets/js/app.6d4de291.js" as="script"><link rel="preload" href="/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/assets/js/11.6c342d53.js" as="script"><link rel="prefetch" href="/assets/js/10.92315ba3.js"><link rel="prefetch" href="/assets/js/12.17474533.js"><link rel="prefetch" href="/assets/js/13.0d4388d1.js"><link rel="prefetch" href="/assets/js/14.a17a1979.js"><link rel="prefetch" href="/assets/js/15.f2e321fa.js"><link rel="prefetch" href="/assets/js/16.ea87d7e4.js"><link rel="prefetch" href="/assets/js/17.0e9e6796.js"><link rel="prefetch" href="/assets/js/3.8dfc125c.js"><link rel="prefetch" href="/assets/js/4.da3ef268.js"><link rel="prefetch" href="/assets/js/5.dac787d8.js"><link rel="prefetch" href="/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/assets/js/7.307492ca.js"><link rel="prefetch" href="/assets/js/8.9f33fbe0.js"><link rel="prefetch" href="/assets/js/9.3c5a8fdb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4dc2ae66.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Apiation Help Center</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/getting-started/" class="nav-link router-link-active">
  Getting Started
</a></div><div class="nav-item"><a href="/help/" class="nav-link">
  Help
</a></div><div class="nav-item"><a href="https://apiation.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Apiation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/getting-started/" class="nav-link router-link-active">
  Getting Started
</a></div><div class="nav-item"><a href="/help/" class="nav-link">
  Help
</a></div><div class="nav-item"><a href="https://apiation.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Apiation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/getting-started/" aria-current="page" class="sidebar-link">Apiation</a></li><li><a href="/getting-started/middleware.html" aria-current="page" class="active sidebar-link">Middleware</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/getting-started/middleware.html#spring-boot-interceptors" class="sidebar-link">Spring boot: interceptors</a></li><li class="sidebar-sub-header"><a href="/getting-started/middleware.html#django-middleware" class="sidebar-link">Django: Middleware</a></li><li class="sidebar-sub-header"><a href="/getting-started/middleware.html#laravel-middleware" class="sidebar-link">Laravel: Middleware</a></li><li class="sidebar-sub-header"><a href="/getting-started/middleware.html#nextjs-middleware" class="sidebar-link">NextJS: Middleware</a></li><li class="sidebar-sub-header"><a href="/getting-started/middleware.html#ruby-rack" class="sidebar-link">Ruby: Rack</a></li><li class="sidebar-sub-header"><a href="/getting-started/middleware.html#express-middleware" class="sidebar-link">Express: Middleware</a></li><li class="sidebar-sub-header"><a href="/getting-started/middleware.html#net-middleware" class="sidebar-link">.NET: Middleware</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="middleware"><a href="#middleware" class="header-anchor">#</a> Middleware</h1> <blockquote><p>Please note that most of these are AI generated and may not be perfect. If you see any errors, please submit a PR to fix them.</p></blockquote> <h2 id="spring-boot-interceptors"><a href="#spring-boot-interceptors" class="header-anchor">#</a> Spring boot: interceptors</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpStatus</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">ResponseEntity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">HandlerInterceptor</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProxyMiddleware</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">RestTemplate</span> restTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">HttpHeaders</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headers<span class="token punctuation">.</span><span class="token function">setBearerAuth</span><span class="token punctuation">(</span><span class="token string">&quot;G3ySAQFZfBzB8VHifhBsFGJq74ibLJZYZ7idMTfl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headers<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> entity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token function">getRequestData</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
            restTemplate<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span><span class="token string">&quot;route('hit')&quot;</span><span class="token punctuation">,</span> <span class="token class-name">HttpMethod</span><span class="token punctuation">.</span><span class="token constant">POST</span><span class="token punctuation">,</span> entity<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// handle exception</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getRequestData</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;method&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;request_data&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">lineSeparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;request_headers&quot;</span><span class="token punctuation">,</span> <span class="token function">headersToJson</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getHeaderNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> request<span class="token operator">::</span><span class="token function">getHeader</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;response_data&quot;</span><span class="token punctuation">,</span> <span class="token function">headersToJson</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getHeaderNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> response<span class="token operator">::</span><span class="token function">getHeader</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">headersToJson</span><span class="token punctuation">(</span><span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> headerNames<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> getHeader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>headerNames<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> headerName <span class="token operator">=</span> headerNames<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headers<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>headerName<span class="token punctuation">,</span> getHeader<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>headerName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// Please note that this example uses HttpServletRequest and HttpServletResponse classes in the Servlet API which is a different way of handling HTTP requests and responses than using Laravel's Request and Response classes. Also the route('hit') is not accessible in this scenario, you will have to provide the exact endpoint URL to post the data.</span>
</code></pre></div><h2 id="django-middleware"><a href="#django-middleware" class="header-anchor">#</a> Django: Middleware</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> JsonResponse
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> reverse
<span class="token keyword">from</span> http <span class="token keyword">import</span> client <span class="token keyword">as</span> http

<span class="token keyword">class</span> <span class="token class-name">ProxyMiddleware</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> get_response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>get_response <span class="token operator">=</span> get_response

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> self<span class="token punctuation">.</span>get_response<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            headers <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">'Content-type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
                <span class="token string">'Authorization'</span><span class="token punctuation">:</span> <span class="token string">'Bearer G3ySAQFZfBzB8VHifhBsFGJq74ibLJZYZ7idMTfl'</span>
            <span class="token punctuation">}</span>
            conn <span class="token operator">=</span> http<span class="token punctuation">.</span>HTTPSConnection<span class="token punctuation">(</span><span class="token string">&quot;route('hit')&quot;</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> 
                         json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">{</span>
                            <span class="token string">'path'</span><span class="token punctuation">:</span> request<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
                            <span class="token string">'method'</span><span class="token punctuation">:</span> request<span class="token punctuation">.</span>method<span class="token punctuation">,</span>
                            <span class="token string">'status'</span><span class="token punctuation">:</span> response<span class="token punctuation">.</span>status_code<span class="token punctuation">,</span>
                            <span class="token string">'request_data'</span><span class="token punctuation">:</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token string">'request_headers'</span><span class="token punctuation">:</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token string">'response_data'</span><span class="token punctuation">:</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token string">'response_headers'</span><span class="token punctuation">:</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">)</span>
                         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token punctuation">)</span>
            res <span class="token operator">=</span> conn<span class="token punctuation">.</span>getresponse<span class="token punctuation">(</span><span class="token punctuation">)</span>
            data <span class="token operator">=</span> res<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">return</span> response
</code></pre></div><h2 id="laravel-middleware"><a href="#laravel-middleware" class="header-anchor">#</a> Laravel: Middleware</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">ProxyMiddleware</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> function <span class="token function">handle</span><span class="token punctuation">(</span>$request<span class="token punctuation">,</span> <span class="token class-name">Closure</span> $next<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">/** @var JsonResponse $response */</span>
        $response <span class="token operator">=</span> $<span class="token function">next</span><span class="token punctuation">(</span>$request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            $attempt <span class="token operator">=</span> \<span class="token class-name">Http</span><span class="token operator">::</span><span class="token function">acceptJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">withToken</span><span class="token punctuation">(</span><span class="token string">&quot;G3ySAQFZfBzB8VHifhBsFGJq74ibLJZYZ7idMTfl&quot;</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">retry</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token char">'hit'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
                    <span class="token char">'path'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> $request<span class="token operator">-&gt;</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token char">'method'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> $request<span class="token operator">-&gt;</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token char">'status'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> $response<span class="token operator">-&gt;</span><span class="token function">getStatusCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    'request_data' <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">json_encode</span><span class="token punctuation">(</span>$request<span class="token operator">-&gt;</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    'request_headers' <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">json_encode</span><span class="token punctuation">(</span>$request<span class="token operator">-&gt;</span>headers<span class="token operator">-&gt;</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    'response_data' <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">json_encode</span><span class="token punctuation">(</span>$response<span class="token operator">-&gt;</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    'response_headers' <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">json_encode</span><span class="token punctuation">(</span>$response<span class="token operator">-&gt;</span>headers<span class="token operator">-&gt;</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>\<span class="token class-name">Exception</span> $e<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> $response<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="nextjs-middleware"><a href="#nextjs-middleware" class="header-anchor">#</a> NextJS: Middleware</h2> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> NextApiRequest<span class="token punctuation">,</span> NextApiResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next'</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">req</span><span class="token operator">:</span> NextApiRequest<span class="token punctuation">,</span> <span class="token literal-property property">res</span><span class="token operator">:</span> NextApiResponse</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;route('hit')&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">path</span><span class="token operator">:</span> req<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
            <span class="token literal-property property">method</span><span class="token operator">:</span> req<span class="token punctuation">.</span>method<span class="token punctuation">,</span>
            <span class="token literal-property property">status</span><span class="token operator">:</span> res<span class="token punctuation">.</span>statusCode<span class="token punctuation">,</span>
            <span class="token literal-property property">request_data</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">,</span>
            <span class="token literal-property property">request_headers</span><span class="token operator">:</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
            <span class="token literal-property property">response_data</span><span class="token operator">:</span> res<span class="token punctuation">.</span>body<span class="token punctuation">,</span>
            <span class="token literal-property property">response_headers</span><span class="token operator">:</span> res<span class="token punctuation">.</span>headers
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
                <span class="token string-property property">'Authorization'</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bearer G3ySAQFZfBzB8VHifhBsFGJq74ibLJZYZ7idMTfl</span><span class="token template-punctuation string">`</span></span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Please note that this example uses the NextApiRequest and NextApiResponse classes provided by the NextJS framework which is a different way of handling HTTP requests and responses than using Laravel's Request and Response classes. Also the route('hit') is not accessible in this scenario, you will have to provide the exact endpoint URL to post the data.</span>
</code></pre></div><h2 id="ruby-rack"><a href="#ruby-rack" class="header-anchor">#</a> Ruby: Rack</h2> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'rack'</span></span>
<span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'json'</span></span>
<span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'net/http'</span></span>

<span class="token keyword">class</span> <span class="token class-name">ProxyMiddleware</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">initialize</span></span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>
    <span class="token variable">@app</span> <span class="token operator">=</span> app
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">call</span></span><span class="token punctuation">(</span>env<span class="token punctuation">)</span>
    status<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> body <span class="token operator">=</span> <span class="token variable">@app</span><span class="token punctuation">.</span>call<span class="token punctuation">(</span>env<span class="token punctuation">)</span>
    <span class="token keyword">begin</span>
      uri <span class="token operator">=</span> <span class="token constant">URI</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'route('</span></span>hit<span class="token string-literal"><span class="token string">')'</span></span><span class="token punctuation">)</span>
      http <span class="token operator">=</span> Net<span class="token double-colon punctuation">::</span><span class="token class-name">HTTP</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span>host<span class="token punctuation">,</span> uri<span class="token punctuation">.</span>port<span class="token punctuation">)</span>
      req <span class="token operator">=</span> Net<span class="token double-colon punctuation">::</span><span class="token constant">HTTP</span><span class="token double-colon punctuation">::</span><span class="token class-name">Post</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span>path<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-literal"><span class="token string">'Content-Type'</span></span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'application/json'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'Authorization'</span></span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;Bearer G3ySAQFZfBzB8VHifhBsFGJq74ibLJZYZ7idMTfl&quot;</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      req<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token symbol">path</span><span class="token operator">:</span> env<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'PATH_INFO'</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token symbol">method</span><span class="token operator">:</span> env<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'REQUEST_METHOD'</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token symbol">status</span><span class="token operator">:</span> status<span class="token punctuation">,</span>
        <span class="token symbol">request_data</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span>parse<span class="token punctuation">(</span>env<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'rack.input'</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>read<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token symbol">request_headers</span><span class="token operator">:</span> env<span class="token punctuation">.</span>select<span class="token punctuation">{</span><span class="token operator">|</span>k<span class="token punctuation">,</span> v<span class="token operator">|</span> k<span class="token punctuation">.</span>start_with<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'HTTP_'</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span>map<span class="token punctuation">{</span><span class="token operator">|</span>k<span class="token punctuation">,</span> v<span class="token operator">|</span> <span class="token punctuation">[</span>k<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token regex-literal"><span class="token regex">/^HTTP_/</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">''</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">.</span>to_h<span class="token punctuation">,</span>
        <span class="token symbol">response_data</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span>parse<span class="token punctuation">(</span>body<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token symbol">response_headers</span><span class="token operator">:</span> headers<span class="token punctuation">.</span>to_h
      <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json
      http<span class="token punctuation">.</span>request<span class="token punctuation">(</span>req<span class="token punctuation">)</span>
    <span class="token keyword">rescue</span> <span class="token builtin">Exception</span> <span class="token operator">=&gt;</span> e
      <span class="token comment">#handle exception</span>
    <span class="token keyword">end</span>
    <span class="token punctuation">[</span>status<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> body<span class="token punctuation">]</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment"># In this scenario route('hit') is not accessible, you will have to provide the exact endpoint URL to post the data. As well as this example is utilizing the core Ruby libraries such as 'rack' and 'net/http' to handle the request and response instead of Laravel's implementation.</span>
</code></pre></div><h2 id="express-middleware"><a href="#express-middleware" class="header-anchor">#</a> Express: Middleware</h2> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">proxyMiddleware</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;route('hit')&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">path</span><span class="token operator">:</span> req<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
            <span class="token literal-property property">method</span><span class="token operator">:</span> req<span class="token punctuation">.</span>method<span class="token punctuation">,</span>
            <span class="token literal-property property">status</span><span class="token operator">:</span> res<span class="token punctuation">.</span>statusCode<span class="token punctuation">,</span>
            <span class="token literal-property property">request_data</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">,</span>
            <span class="token literal-property property">request_headers</span><span class="token operator">:</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
            <span class="token literal-property property">response_data</span><span class="token operator">:</span> res<span class="token punctuation">.</span>body<span class="token punctuation">,</span>
            <span class="token literal-property property">response_headers</span><span class="token operator">:</span> res<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
                <span class="token string-property property">'Authorization'</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bearer G3ySAQFZfBzB8VHifhBsFGJq74ibLJZYZ7idMTfl</span><span class="token template-punctuation string">`</span></span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// handle error</span>
    <span class="token punctuation">}</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>proxyMiddleware
<span class="token comment">// Please note that in this example route('hit') is not accessible. You will have to provide the exact endpoint URL to post the data. Also this example utilizes the express.js library which is a different way of handling HTTP requests and responses than using Laravel's Request and Response classes.</span>
</code></pre></div><h2 id="net-middleware"><a href="#net-middleware" class="header-anchor">#</a> .NET: Middleware</h2> <div class="language-C# extra-class"><pre class="language-text"><code>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/getting-started/" class="prev router-link-active">
        Apiation
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6d4de291.js" defer></script><script src="/assets/js/2.733019b2.js" defer></script><script src="/assets/js/11.6c342d53.js" defer></script>
  </body>
</html>
